[Interface]
PrivateKey = <PRIVATE_KEY>
Address = <VPN_ADDRESS>
DNS = 1.1.1.1, 1.0.0.1
Table = off
# MTU = 1280                    # Uncomment if you have packet fragmentation issues

# AmneziaWG obfuscation parameters (paste from AmneziaVPN app export)
Jc =
Jmin =
Jmax =
S1 =
S2 =
H1 =
H2 =
H3 =
H4 =

# ── Routing ─────────────────────────────────────────────────────────────────
# Replace these placeholders with your actual values (see README for how):
#   <HOST_IP>       — your host's public/source IP    (curl -s ifconfig.me)
#   <GATEWAY>       — default gateway IP              (ip route | grep default)
#   <DEV>           — default network interface name   (ip route | grep default)
#   <VPN_ENDPOINT>  — VPN server IP from Endpoint line below

# PostUp:
#  1. Protect SSH — keep HOST_IP traffic on main routing table
#  2. Route VPN endpoint via real gateway (avoid routing loop)
#  3. Default route through VPN tunnel (metric 50 = high priority)
#  4. (Optional) Append VPN DNS — see note below
PostUp = ip rule add from <HOST_IP> lookup main prio 100; ip route add <VPN_ENDPOINT> via <GATEWAY> dev <DEV>; ip route add default dev wg0 metric 50

# PreDown: restore DNS from backup, then reverse routing in opposite order
PreDown = ip route del default dev wg0 metric 50; ip route del <VPN_ENDPOINT> via <GATEWAY> dev <DEV>; ip rule del from <HOST_IP> lookup main prio 100

# ── DNS note ──────────────────────────────────────────────────────────────
# If your host uses systemd-resolved (check: ls -l /etc/resolv.conf),
# /etc/resolv.conf is a symlink managed by systemd. In that case:
#   - Remove the DNS parts from PostUp/PreDown (the cp and echo commands)
#   - systemd-resolved (127.0.0.53) keeps working over loopback and its
#     upstream queries go through wg0 automatically
#   - Custom search domains  continue resolving
#
# Simplified PostUp/PreDown without DNS (for systemd-resolved hosts):
#   PostUp  = ip rule add from <HOST_IP> lookup main prio 100; ip route add <VPN_ENDPOINT> via <GATEWAY> dev <DEV>; ip route add default dev wg0 metric 50
#   PreDown = ip route del default dev wg0 metric 50; ip route del <VPN_ENDPOINT> via <GATEWAY> dev <DEV>; ip rule del from <HOST_IP> lookup main prio 100

[Peer]
PublicKey = <PEER_PUBLIC_KEY>
PresharedKey = <PRESHARED_KEY>
AllowedIPs = 0.0.0.0/0, ::/0
Endpoint = <VPN_ENDPOINT>:<PORT>
PersistentKeepalive = 25
