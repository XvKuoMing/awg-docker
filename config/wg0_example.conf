[Interface]
PrivateKey = <PRIVATE_KEY>
Address = <VPN_ADDRESS>
# DNS is handled in PostUp/PreDown (resolvconf does not work inside the container)
Table = off
# MTU = 1280                    # Uncomment if you have packet fragmentation issues

# AmneziaWG obfuscation parameters (paste from AmneziaVPN app export)
Jc =
Jmin =
Jmax =
S1 =
S2 =
H1 =
H2 =
H3 =
H4 =

# ── Routing ─────────────────────────────────────────────────────────────────
# Replace these placeholders with your actual values (see README for how):
#   <HOST_IP>       — your host's public/source IP    (curl -s ifconfig.me)
#   <GATEWAY>       — default gateway IP              (ip route | grep default)
#   <DEV>           — default network interface name   (ip route | grep default)
#   <VPN_ENDPOINT>  — VPN server IP from Endpoint line below

# PostUp:
#  1. Protect SSH — keep HOST_IP traffic on main routing table
#  2. Route VPN endpoint via real gateway (avoid routing loop)
#  3. Default route through VPN tunnel (metric 50 = high priority)
#  4. Append VPN DNS servers (resolvconf doesn't work in a container)
#     Using >> (append) keeps your existing DNS entries (e.g. custom/local resolvers)
#     at the top so they are queried first. VPN DNS is used as fallback.
PostUp = ip rule add from <HOST_IP> lookup main prio 100; \
         ip route add <VPN_ENDPOINT> via <GATEWAY> dev <DEV>; \
         ip route add default dev wg0 metric 50; \
         cp /etc/resolv.conf /etc/resolv.conf.bak; \
         echo -e "nameserver 1.1.1.1\nnameserver 1.0.0.1" >> /etc/resolv.conf

# PreDown: restore DNS from backup, then reverse routing in opposite order
PreDown = cp /etc/resolv.conf.bak /etc/resolv.conf; \
          ip route del default dev wg0 metric 50; \
          ip route del <VPN_ENDPOINT> via <GATEWAY> dev <DEV>; \
          ip rule del from <HOST_IP> lookup main prio 100

[Peer]
PublicKey = <PEER_PUBLIC_KEY>
PresharedKey = <PRESHARED_KEY>
AllowedIPs = 0.0.0.0/0, ::/0
Endpoint = <VPN_ENDPOINT>:<PORT>
PersistentKeepalive = 25
